run:
  timeout: 10m
  tests: true
  skip-files:
    - "doc.go"
    - "zz_generated.*.go"
    - "generated.*.go"
  modules-download-mode: readonly

# output configuration options
output:
  format: colored-line-number
  print-issued-lines: true
  print-linter-name: true
  uniq-by-line: true
  path-prefix: ""
  sort-results: true

linters:
  disable-all: true
  enable:
    - asciicheck
    - bidichk
    - decorder
    - durationcheck
    - errcheck
    - errname
    - errorlint
    - exportloopref
    - godot
    - goconst
    - gocritic
    - gosimple
    - gosec
    - govet
    - gofumpt
    - gofmt
    - ineffassign
    - importas
    - lll
    - makezero
    - misspell
    - nakedret
    - nilerr
    - prealloc
    - predeclared
    - revive
    - staticcheck
    - stylecheck
    - typecheck
    - unconvert
    - unparam
    - unused
    - usestdlibvars
    - whitespace

    # enable complexity linters
    # - dupl
    # - gocognit
    # - gocyclo
    # - funlen

linters-settings:
  decorder:
    dec-order:
      - const
      - var
      - func
    disable-init-func-first-check: false
    disable-dec-order-check: true
  errorlint:
    errorf: true
    asserts: true
    comparison: true
  godot:
    scope: all
    exclude:
      - "(?i)^ FIXME:"
      - "(?i)^ TODO:"
      - "(?i)^ SPDX\\-License\\-Identifier:"
      - "(?i)^ +"
    period: true
    capital: false
  goconst:
    min-len: 3
    min-occurrences: 10
  gosimple:
    go: "1.21"
    checks: [ "all" ]
  gosec:
    severity: "low"
    confidence: "low"
    excludes:
      - G101
      - G107
      - G112
      - G404
  gofumpt:
    extra-rules: true
  gofmt:
    simplify: true
    rewrite-rules:
      - pattern: 'interface{}'
        replacement: 'any'
      - pattern: 'a[b:len(a)]'
        replacement: 'a[b:]'
  importas:
    no-unaliased: true
    alias:
      # Kubernetes
      - pkg: k8s.io/apimachinery/pkg/api/meta
        alias: kmeta
      - pkg: k8s.io/apimachinery/pkg/api/errors
        alias: kerrors
      - pkg: k8s.io/apimachinery/pkg/util/errors
        alias: utilerrors
      # Controller Runtime
      - pkg: sigs.k8s.io/controller-runtime
        alias: ctrl
      - pkg: sigs.k8s.io/controller-runtime/pkg/log
        alias: ctrllog
      - pkg: sigs.k8s.io/controller-runtime/pkg/reconcile
        alias: ctrlreconcile
      - pkg: sigs.k8s.io/controller-runtime/pkg/webhook
        alias: ctrlwebhook
      - pkg: sigs.k8s.io/controller-runtime/pkg/webhook/admission
        alias: ctrladmission
      - pkg: sigs.k8s.io/controller-runtime/pkg/cache
        alias: ctrlcache
      - pkg: sigs.k8s.io/controller-runtime/pkg/client
        alias: ctrlcli
      - pkg: sigs.k8s.io/controller-runtime/pkg/metrics/server
        alias: ctrlmetricsrv
      - pkg: sigs.k8s.io/controller-runtime/pkg/metrics
        alias: ctrlmetrics
      - pkg: sigs.k8s.io/controller-runtime/pkg/controller/controllerutil
        alias: ctrlutil
  lll:
    line-length: 150
    tab-width: 1
  makezero:
    always: false
  misspell:
    locale: US
  nakedret:
    max-func-lines: 60
  revive:
    rules:
      - name: var-naming
        disabled: true
        arguments:
          - [ "HTTP", "ID", "TLS", "TCP", "UDP", "API", "CA", "URL", "DNS" ]
  staticcheck:
    checks: [ "all", "-SA1019", "-SA2002", "-SA5008" ]
  stylecheck:
    checks: [ "all", "-ST1003" ]
  unparam:
    check-exported: false
  unused:
    field-writes-are-uses: true
    post-statements-are-reads: true
    exported-is-used: true
    exported-fields-are-used: true
    parameters-are-used: true
    local-variables-are-used: true
    generated-is-used: true
  usestdlibvars:
    http-method: true
    http-status-code: true
    time-weekday: true
    time-month: true
    time-layout: true
    crypto-hash: true

issues:
  exclude-rules:
    - path: _test\.go
      linters:
        - errcheck
        - gosec
        - makezero
        - lll
