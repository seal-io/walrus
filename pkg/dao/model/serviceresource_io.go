// SPDX-FileCopyrightText: 2023 Seal, Inc
// SPDX-License-Identifier: Apache-2.0

// Code generated by "ent". DO NOT EDIT.

package model

import (
	"time"

	"github.com/seal-io/seal/pkg/dao/types"
	"github.com/seal-io/seal/pkg/dao/types/object"
)

// ServiceResourceQueryInput is the input for the ServiceResource query.
type ServiceResourceQueryInput struct {
	// ID holds the value of the "id" field.
	ID object.ID `uri:"id,omitempty" json:"id,omitempty"`
}

// Model converts the ServiceResourceQueryInput to ServiceResource.
func (in ServiceResourceQueryInput) Model() *ServiceResource {
	return &ServiceResource{
		ID: in.ID,
	}
}

// ServiceResourceCreateInput is the input for the ServiceResource creation.
type ServiceResourceCreateInput struct {
	// ID of the project to belong.
	ProjectID object.ID `json:"projectID"`
	// Mode that manages the generated resource, it is the management way of the deployer to the resource, which provides by deployer.
	Mode string `json:"mode"`
	// Type of the generated resource, it is the type of the resource which the deployer observes, which provides by deployer.
	Type string `json:"type"`
	// Name of the generated resource, it is the real identifier of the resource, which provides by deployer.
	Name string `json:"name"`
	// Type of deployer.
	DeployerType string `json:"deployerType"`
	// Shape of the resource, it can be class or instance shape.
	Shape string `json:"shape"`
	// Status of the resource.
	Status types.ServiceResourceStatus `json:"status,omitempty"`
	// Composition holds the value of the composition edge.
	Composition *ServiceResourceQueryInput `json:"composition,omitempty"`
	// Class holds the value of the class edge.
	Class *ServiceResourceQueryInput `json:"class,omitempty"`
	// Dependencies holds the value of the dependencies edge.
	Dependencies []*ServiceResourceRelationshipCreateInput `json:"dependencies,omitempty"`
}

// Model converts the ServiceResourceCreateInput to ServiceResource.
func (in ServiceResourceCreateInput) Model() *ServiceResource {
	var entity = &ServiceResource{
		ProjectID:    in.ProjectID,
		Mode:         in.Mode,
		Type:         in.Type,
		Name:         in.Name,
		DeployerType: in.DeployerType,
		Shape:        in.Shape,
		Status:       in.Status,
	}
	if in.Composition != nil {
		entity.CompositionID = in.Composition.ID
	}
	if in.Class != nil {
		entity.ClassID = in.Class.ID
	}
	for i := 0; i < len(in.Dependencies); i++ {
		if in.Dependencies[i] == nil {
			continue
		}
		entity.Edges.Dependencies = append(entity.Edges.Dependencies, in.Dependencies[i].Model())
	}
	return entity
}

// ServiceResourceUpdateInput is the input for the ServiceResource modification.
type ServiceResourceUpdateInput struct {
	// ID holds the value of the "id" field.
	ID object.ID `uri:"id" json:"-"`
	// Status of the resource.
	Status types.ServiceResourceStatus `json:"status,omitempty"`
	// Dependencies holds the value of the dependencies edge.
	Dependencies []*ServiceResourceRelationshipUpdateInput `json:"dependencies,omitempty"`
}

// Model converts the ServiceResourceUpdateInput to ServiceResource.
func (in ServiceResourceUpdateInput) Model() *ServiceResource {
	var entity = &ServiceResource{
		ID:     in.ID,
		Status: in.Status,
	}
	for i := 0; i < len(in.Dependencies); i++ {
		if in.Dependencies[i] == nil {
			continue
		}
		entity.Edges.Dependencies = append(entity.Edges.Dependencies, in.Dependencies[i].Model())
	}
	return entity
}

// ServiceResourceOutput is the output for the ServiceResource.
type ServiceResourceOutput struct {
	// ID holds the value of the "id" field.
	ID object.ID `json:"id,omitempty"`
	// CreateTime holds the value of the "createTime" field.
	CreateTime *time.Time `json:"createTime,omitempty"`
	// UpdateTime holds the value of the "updateTime" field.
	UpdateTime *time.Time `json:"updateTime,omitempty"`
	// ID of the project to belong.
	ProjectID object.ID `json:"projectID,omitempty"`
	// Mode that manages the generated resource, it is the management way of the deployer to the resource, which provides by deployer.
	Mode string `json:"mode,omitempty"`
	// Type of the generated resource, it is the type of the resource which the deployer observes, which provides by deployer.
	Type string `json:"type,omitempty"`
	// Name of the generated resource, it is the real identifier of the resource, which provides by deployer.
	Name string `json:"name,omitempty"`
	// Type of deployer.
	DeployerType string `json:"deployerType,omitempty"`
	// Shape of the resource, it can be class or instance shape.
	Shape string `json:"shape,omitempty"`
	// Status of the resource.
	Status types.ServiceResourceStatus `json:"status,omitempty"`
	// Service to which the resource belongs.
	Service *ServiceOutput `json:"service,omitempty"`
	// Connector to which the resource deploys.
	Connector *ConnectorOutput `json:"connector,omitempty"`
	// Composition holds the value of the composition edge.
	Composition *ServiceResourceOutput `json:"composition,omitempty"`
	// Sub-resources that make up the resource.
	Components []*ServiceResourceOutput `json:"components,omitempty"`
	// Class holds the value of the class edge.
	Class *ServiceResourceOutput `json:"class,omitempty"`
	// Service resource instances to which the resource defines.
	Instances []*ServiceResourceOutput `json:"instances,omitempty"`
	// Dependencies holds the value of the dependencies edge.
	Dependencies []*ServiceResourceRelationshipOutput `json:"dependencies,omitempty"`
	// Keys is the list of key used for operating the service resource,
	// it does not store in the database and only records for additional operations.
	Keys *types.ServiceResourceOperationKeys `json:"keys,omitempty"`
}

// ExposeServiceResource converts the ServiceResource to ServiceResourceOutput.
func ExposeServiceResource(in *ServiceResource) *ServiceResourceOutput {
	if in == nil {
		return nil
	}
	var entity = &ServiceResourceOutput{
		ID:           in.ID,
		CreateTime:   in.CreateTime,
		UpdateTime:   in.UpdateTime,
		ProjectID:    in.ProjectID,
		Mode:         in.Mode,
		Type:         in.Type,
		Name:         in.Name,
		DeployerType: in.DeployerType,
		Shape:        in.Shape,
		Status:       in.Status,
		Service:      ExposeService(in.Edges.Service),
		Connector:    ExposeConnector(in.Edges.Connector),
		Composition:  ExposeServiceResource(in.Edges.Composition),
		Components:   ExposeServiceResources(in.Edges.Components),
		Class:        ExposeServiceResource(in.Edges.Class),
		Instances:    ExposeServiceResources(in.Edges.Instances),
		Dependencies: ExposeServiceResourceRelationships(in.Edges.Dependencies),
	}
	if in.ServiceID != "" {
		if entity.Service == nil {
			entity.Service = &ServiceOutput{}
		}
		entity.Service.ID = in.ServiceID
	}
	if in.ConnectorID != "" {
		if entity.Connector == nil {
			entity.Connector = &ConnectorOutput{}
		}
		entity.Connector.ID = in.ConnectorID
	}
	if in.CompositionID != "" {
		if entity.Composition == nil {
			entity.Composition = &ServiceResourceOutput{}
		}
		entity.Composition.ID = in.CompositionID
	}
	if in.ClassID != "" {
		if entity.Class == nil {
			entity.Class = &ServiceResourceOutput{}
		}
		entity.Class.ID = in.ClassID
	}
	entity.Keys = in.Keys

	return entity
}

// ExposeServiceResources converts the ServiceResource slice to ServiceResourceOutput pointer slice.
func ExposeServiceResources(in []*ServiceResource) []*ServiceResourceOutput {
	var out = make([]*ServiceResourceOutput, 0, len(in))
	for i := 0; i < len(in); i++ {
		var o = ExposeServiceResource(in[i])
		if o == nil {
			continue
		}
		out = append(out, o)
	}
	if len(out) == 0 {
		return nil
	}
	return out
}
